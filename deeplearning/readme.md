# 训练数据的预处理

​	我们得到的训练数据是包含实验者一些行为片段的数据包，每个数据包的大小宽度为20，长度为0~300之间不等。为了方便训练过程，我们对训练数据进行归一化的处理，将每一个训练数据的规格大小归一化为20×320，将多出的部分进行补零处理，因为补零对于训练结果没有影响，为了方便训练，我们将其形状重置为80×80×1。

# 卷积神经网络的建立

​	神经网络模型的建立，采用了八层的结构。首先是第一层卷积层，定义原始训练数据规格大小80×80×1,该卷积层中采用边长为5，深度为32的过滤器，过滤器设置的移动步长为1,且使用全零填充，所以最后得到的结果是80×80×32的矩阵；第二层池化层的前向传播过程，选用最大池化层，池化层过滤器的边长为2，使用全0填充且移动的步长为2。该层的输入为上一层的输出结果即80×80×32,经过池化后结果为40×40×32的矩阵；第三层卷积层，该卷积层中采用边长为5，深度为64的过滤器，过滤器设置的移动步长为1,且使用全0填充，所以最后得到的结果是40×40×64的矩阵；第四层池化层的前向传播过程和第二层一样，该层的输入为上一层的输出结果即40×40×64,经过池化后结果为20×20×64的矩阵；第五层卷积层，该卷积层中采用边长为5，深度为128的过滤器，过滤器设置的移动步长为1,且使用全0填充，所以最后得到的结果是20×20×128的矩阵；第六层池化层的前向传播过程和第二层一样，该层的输入为上一层的输出结果即20×20×128,经过池化后结果为10×10×128的矩阵；第七层为全连接层，该层引入了dropout的概念，用来防止过拟合问题,提高模型的效果，而该层的输入就是拉直之后的一组向量，向量的长度即为10×10×128=12800，输出为一组长度为512的向量。 第八层为全连接层，该层的输入为上层输出结果，即一组长度为512的向量，输出根据实验对象的个数而定，因为我们五人，除去没有意义的标签0，所以我们输出的结果为6的向量，这一层的输出通过Softmax之后就得到了最后分类的结果。

# 结果分析

​	该部分主要是基于CNN模型的身份识别，我们的实验者人数为5，对于每个人采集他们的行为信息，平均每个人对应120个数据包，我们随机选取其中30%作为测试集，70%作为训练集。模型建立后，对测试集进行测试，结果如下图所示。对于正常情况下身份识别的准确率达到了100%，而对于非常相似的实验者来说，准确率就会比较低，通过实验的数据可以认为行为识别的过程确实有效，对于正常情况下具有不错的识别效果。

![Image text](https://github.com/lyhlcz/lyhcode/blob/master/deeplearning/confusion_matrix.png)

##  优缺点

对于绝大多数人来说由于行为习惯，身体体型等均不相同，我们通过基于wifi信号采集的行为信息，通过一些处理，然后通过对训练数据进行卷积，池化等处理来提取更加有效的特征，最后用于人身份的识别，这样的方式不但操作简单，对设备的要求较低，同时也有较高的正确率。当然也有些不足之处对于包含体型，行为均相似的实验者来说，就会造成混淆过度，模型会分不清他们的身份，这样就存在可靠性较低的现象。

## 改善措施

针对一些身份混淆过度现象，我们也采取相应的措施。通过实验数据我们发现混淆过度只会出现这些相似的实验者，假如我们将这些相似的人归为一类时，那么训练模型的正确率就会变得很高。所以我们可以将这些相似人的训练数据从总体中分离出来，单独建立一个神经网络模型，来更加准确的区分他们以达到更好的效果。这样以原来的神经网络模型得出的结果为主，对于混淆过度的人来说，我们再以新建立模型为辅，设置好相关的权重，最终得到比较准确的结果。